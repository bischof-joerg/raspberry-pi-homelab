global:
  smtp_smarthost: "${ALERT_SMTP_SMARTHOST}"
  smtp_from: "${ALERT_SMTP_FROM}"
  smtp_auth_username: "${ALERT_SMTP_AUTH_USERNAME}"
  smtp_auth_password: "${ALERT_SMTP_AUTH_PASSWORD}"
  smtp_require_tls: ${ALERT_SMTP_REQUIRE_TLS}

route:
  receiver: email-warning
  group_by: ["alertname", "instance"]
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 4h

  routes:
    - matchers:
        - severity="critical"
      receiver: email-critical
      repeat_interval: 2h

inhibit_rules:
  - source_matchers:
      - severity="critical"
    target_matchers:
      - severity="warning"
    equal: ["alertname", "instance"]

receivers:
  - name: email-critical
    email_configs:
      - to: "${ALERT_EMAIL_TO}"
        send_resolved: true

  - name: email-warning
    email_configs:
      - to: "${ALERT_EMAIL_TO}"
        send_resolved: true

templates:
  - /etc/alertmanager/templates/*.tmpl
